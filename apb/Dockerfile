FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBrYWZrYS1vcGVyYXRvci1sYWItYXBiCmRlc2NyaXB0aW9u\
OiBBUEIgdG8gZGVwbG95IEthZmthIE9wZXJhdG9yIExhYiAoSG9tZXJvb20pIGFuIE9wZW5TaGlm\
dCBjbHVzdGVyCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczoKLSB3b3Jrc2hv\
cAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIkthZmthIE9wZXJhdG9yIExhYiAoSG9tZXJvb20p\
IgogIGxvbmdEZXNjcmlwdGlvbjogfC0KICAgIEluc3RhbGxzIGEgd29ya3Nob3Agc3Bhd25lciBm\
b3IgS2Fma2EgT3BlcmF0b3IgbGFiIGluIEhvbWVyb29tCiAgY29uc29sZS5vcGVuc2hpZnQuaW8v\
aWNvbkNsYXNzOiAiZmEgZmEtaG9tZSIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwg\
SW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogRGVwbG95cyBL\
YWZrYSBPcGVyYXRvciBMYWIgKEhvbWVyb29tKQogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6\
CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBh\
ZG1pbl91c2VyCiAgICAgIHRpdGxlOiBBZG1pbiBVc2VybmFtZQogICAgICBkZXNjcmlwdGlvbjog\
VXNlciBpcyByZXF1aXJlZCBmb3IgY3JlYXRpbmcgcHJvamVjdCBhZG1pbiByZXNvdXJjZXMKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRpc3BsYXlfdHlwZTog\
dGV4dAogICAgICBkaXNwbGF5X2dyb3VwOiBJbnN0YWxsIFVzZXIKICAgIC0gbmFtZTogYWRtaW5f\
cGFzc3dvcmQKICAgICAgdGl0bGU6IEFkbWluIFBhc3N3b3JkCiAgICAgIGRlc2NyaXB0aW9uOiBQ\
YXNzd29yZCBpcyByZXF1aXJlZCBmb3IgY3JlYXRpbmcgcHJvamVjdCBhZG1pbiByZXNvdXJjZXMK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRpc3BsYXlfdHlw\
ZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogSW5zdGFsbCBVc2VyCiAgICAtIG5hbWU6\
IHJlc291cmNlX2J1ZGdldAogICAgICB0aXRsZTogU2l6ZSBvZiB0aGUgcmVzb3VyY2VzCiAgICAg\
IGRlc2NyaXB0aW9uOiBULVNoaXJ0IHNpemUgZm9yIGRldGVybWluaW5nIHRoZSBhc3NpZ25lZCBy\
ZXNvdXJjZXMgdG8gdGhlIGxhYiBwcm9qZWN0cwogICAgICB0eXBlOiBlbnVtCiAgICAgIGVudW06\
IFsnc21hbGwnLCdtZWRpdW0nLCdsYXJnZScsICd4LWxhcmdlJywneHgtbGFyZ2UnLCd4eHgtbGFy\
Z2UnXQogICAgICBkZWZhdWx0OiAieC1sYXJnZSIKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICAg\
IGRpc3BsYXlfdHlwZTogc2VsZWN0CiAgICAgIGRpc3BsYXlfZ3JvdXA6IFdvcmtzaG9wCiAgICAt\
IG5hbWU6IHNwYXduZXJfdGVtcGxhdGVfdmVyc2lvbgogICAgICB0aXRsZTogU3Bhd25lciB2ZXJz\
aW9uIHRvIHVzZQogICAgICBkZXNjcmlwdGlvbjogVmVyc2lvbiBvZiB0aGUgc3Bhd25lciB0ZW1w\
bGF0ZSB0byB1c2Ugd2hlbiBkZXBsb3lpbmcgaG9tZXJvb20KICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIGRlZmF1bHQ6ICIzLjIuMSIKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IEFkdmFuY2VkCiAgICAtIG5hbWU6IHdvcmtzaG9wX2ltYWdlX25hbWUKICAgICAgdGl0\
bGU6IFdvcmtzaG9wIGltYWdlIG5hbWUKICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIHdv\
cmtzaG9wIGltYWdlIHRvIHVzZSBmb3IgdGhpcyBsYWIKICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
IGRlZmF1bHQ6ICJxdWF5LmlvL29wZW5zaGlmdGxhYnMvbGFiLWthZmthLW9wZXJhdG9yIgogICAg\
ICByZXF1aXJlZDogZmFsc2UKICAgICAgZGlzcGxheV9ncm91cDogQWR2YW5jZWQKICAgIC0gbmFt\
ZTogd29ya3Nob3BfaW1hZ2VfdGFnCiAgICAgIHRpdGxlOiBXb3Jrc2hvcCBpbWFnZSB0YWcKICAg\
ICAgZGVzY3JpcHRpb246IFRhZyBvZiB0aGUgd29ya3Nob3AgaW1hZ2UgdG8gdXNlIGZvciB0aGlz\
IGxhYgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogIjEuNCIKICAgICAgcmVxdWly\
ZWQ6IGZhbHNlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEFkdmFuY2VkCg=="

COPY playbooks /opt/apb/actions
COPY . /opt/ansible
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
